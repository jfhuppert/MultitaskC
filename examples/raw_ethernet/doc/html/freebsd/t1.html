<HTML
><HEAD
><TITLE
>FreeBSD network booting</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.7"></HEAD
><BODY
CLASS="article"
><DIV
CLASS="ARTICLE"
><DIV
CLASS="TITLEPAGE"
><H1
CLASS="title"
><A
NAME="AEN2"
></A
>FreeBSD network booting</H1
><H3
CLASS="author"
><A
NAME="AEN4"
>Doug Ambrisko (?)</A
></H3
><P
CLASS="pubdate"
>16 October 1999<BR></P
><DIV
><DIV
CLASS="abstract"
><A
NAME="AEN7"
></A
><P
></P
><P
>&#13;These are some notes on FreeBSD network booting with etherboot.
</P
><P
></P
></DIV
></DIV
><HR></DIV
><P
>&#13;Add kernel configuration via bootp to kernel.  You can see more options
in LINT, these are a good set
</P
><P
>&#13;
<TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>&#13;  # Kernel BOOTP support  
  options         BOOTP           # Use BOOTP to obtain IP address/hostname
  options         BOOTP_NFSROOT   # NFS mount root filesystem using BOOTP info
  options         BOOTP_NFSV3     # Use NFS v3 to NFS mount root
  options         BOOTP_COMPAT    # Workaround for broken bootp daemons.
</PRE
></TD
></TR
></TABLE
>

</P
><P
>&#13;Setup Bootp server or DHCP server, here is an example entry for /etc/bootptab
refer to the man page bootpd for more information.
</P
><P
>&#13;
<TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>&#13;       .default:\
             :sm=255.255.255.0:\
             :gw=your.gateway.ip:\
             :hn:ht=ether:vm=rfc1048:\
             :rp="rootfs.ip:/rootfs/path":\
             :T128="swapfs.ip:/swapfs/path":\
             :T129=swapsize:\
             :T130="root,mount,options":\
             :T131="swap,mount,options":\
             :ra=255.255.255.255:
       client01:bf="kernel":ha=00400530d6d9:tc=.default:
</PRE
></TD
></TR
></TABLE
>

</P
><P
>&#13;Enable bootpd in inetd by uncommented the "bootps" line.
</P
><P
>&#13;Setup tftpd, copy your kernel into you tftpboot directory.  Note you should
make the kernel accessible in both the rootfs and the tftpboot area.
</P
><P
>&#13;Enable tftpd by uncommenting tftp in /etc/inetd.conf.  If you give the
full kernel path then remove the /tftpboot directory option in inetd.conf.
Again for more information look at man tftpd.
</P
><P
>&#13;Send a SIGHUP to the inetd process.
</P
><P
>&#13;Make sure you export the rootfs, in /etc/exports and SIGHUP mountd if
needed.  Refer to the man page mountd for more information.
</P
><P
>&#13;The swapfile if specified will need to be created.  Just do a "dd" of
/dev/zero for the size you want into the path specified in the bootptab
with the IP address appended for example:

<TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="100%"
><TR
><TD
><PRE
CLASS="programlisting"
>&#13;	/usr/exports/swap/swap.192.168.1.1
</PRE
></TD
></TR
></TABLE
>

</P
><P
>&#13;Now you should be ready to boot diskless.
</P
><P
>&#13;Note there are some useful boot time configuration file in /etc/rc.diskless.
</P
><P
>&#13;Note2 NFS mount of root was broken in current it has been fixed.
</P
></DIV
></BODY
></HTML
>